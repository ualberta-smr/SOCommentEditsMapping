import argparse
import sqlite3
import time
import pandas as pd

from generate import generate_result_stats, generate_simple_csvs, generate_stat_csv, get_tags
from processor import Processor
from evaluate import evaluate
from package import package


def setup_sqlite(conn):
    c = conn.cursor()
    create_edit_history = open("sql/EditHistory.sql", "r")
    script = create_edit_history.read()
    create_edit_history.close()
    c.executescript(script)
    conn.commit()

    create_smr_tables = open("sql/EditHistory_Code.sql", "r")
    script = create_smr_tables.read()
    create_smr_tables.close()
    c.executescript(script)
    conn.commit()

    c.close()


def create_subquery():
    tags = get_tags()
    sub_query = "SELECT DISTINCT PostId FROM EditHistory WHERE Tags LIKE '%{}%'".format(tags[0])
    for tag in tags[1:]:
        sub_query += " OR Tags LIKE '%{}%'".format(tag)
    return sub_query


def get_data(conn):
    df_answers = pd.read_sql_query(
        "SELECT * FROM EditHistory_Code WHERE Event = 'InitialBody' AND PostId IN (818313,939060,1417254,1276894,1804490,2061144,2256556,3366318,3347598,3383237,4040641,4323607,4357318,4605982,5112457,5326382,5553947,6330456,6872517,6954573,7271326,7498411,6908115,7891698,8203073,9043462,9236878,9239808,9397206,9556452,9630432,9686046,10060390,10150458,2206432,10284119,10343816,10374564,10405545,10498341,10547344,11020094,11217492,11649404,11847167,11884184,12002701,12024009,12154831,12242834,12452881,12586471,12638451,12836218,12892964,13039557,13479302,13594807,13608535,13636838,13675924,13703279,13821778,14146919,14274978,14499028,14778058,14861957,15013259,15030050,15555250,15795118,15801490,15762726,15836989,15883604,15957975,15976303,15984885,16251905,16346563,16433740,7080110,17057187,17191396,17319638,17534943,17599402,17761938,17829520,17890507,17913039,18048949,18194951,18243157,18443074,18493467,18505187,18894906,19120443,19170570,19345640,19941171,20051167,20281502,20389922,20522648,20564980,20643356,20682670,20830515,20979166,20982407,21051450,21221088,21397451,21467987,21508484,21563424,21574754,21546112,21900743,21928787,22244318,19760247,22453634,22547276,22558242,22632211,22719774,22729235,22755610,22790433,22801381,22815825,23047291,23485518,23596935,23746834,23836513,23966454,23966579,24053116,24097089,24097395,24112752,24222260,24261239,24354619,24374760,24466679,24527796,13490879,24711801,24994747,25048956,25213188,25363478,25478667,25567294,25570082,25722877,25941522,26128045,26131972,26166810,26275516,26464722,22840483,26575292,26684874,26707401,26742187,26743196,26875502,26895625,26963815,26996935,27129527,27249942,27300544,27460666,27467436,27598202,28161001,28246170,28372662,28567081,28759071,29019668,29059351,29065976,21757928,4903603,29497063,29590346,29690325,29787277,29720760,29811000,29990543,30006033,30006383,30007770,30030466,30040186,30065760,30199210,30279363,30511497,30866171,30994088,31392227,31494182,31545286,31799561,31874400,32236521,32545385,32749983,32754922,33075045,33114312,33191611,33776967,34629675,35004710,35739045,35743682,35890604,36269980,36320155,36486897,36565615,36608850,37012846,37066827,37173859,37285008,37339594,37318859,37453268,37508304,37697179,37762134,37769932,37992391,38024945,38037269,38400960,38536173,38587221,38667012,38699205,33437366,38783706,35219474,38824811,39167699,39220959,39281965,39566876,39569666,39706712,39796059,40096675,40164633,40201740,21970805,40440530,40474532,40605034,41083139,41462630,6667403,41568370,41609515,41662470,41761656,41770767,41843713,42374536,42464496,42469760,42505230,42525241,42666184,42722091,42745270,42842593,43100605,43136269,43279035,43280212,43361112,43511213,43642366,27506104,43770851,43835126,43875064,44364052,44398934,44405921,44460065,45111288,45337346,45488299,45857726,45720860,46393474,46428741,46671750,46675245,46770584,46911175,47104641,47406508,47415643,47545712,47582363,47743840,47818939,47845637,48210898,48391112,48417942,48430421,48445377,48608229,48909781,49054649,49060906,27173320,49324753,49488361,49556258,49594320,49605667,49611325,49879709,49876892,50064265,50085689,50107889,50153682,50196591,50328445,50416883,50401250,50547398,50942905,51537352,51664465,52098233,52172471,52324512,52466191,52517618,52524114,52879125,52980017,53062115,53175054,53216022,53354155,53644456,53692842,53708081,53830302,53852343,53927692,54615947,54892387,54886614,55117356,55652916,55788001,55855047,55879567,55884358,55957419,7875,1757843,2486471,2494473,2550109,2861345,2901136,2931250,3180655,3359695,3517919,3835837,3941993,3998810,4002998,4067488,4132683,4221530,4324452,4528579,4769473,4812456,4941028,4942094,5518611,5586896,5616616,6010680,6722434,7008045,7078376,7126108,7235584,7460596,7499793,7544391,7936715,7947296,7967539,8037909,8253636,8329078,8365193,8525234,8832616,8961590,9247380,9575427,9671062,9756189,9765719,9842690,9946432,9967906,10002834,10059880,10261872,10270684,10273530,10457243,10474157,10575359,10675391,10986507,11013401,11100438,11261905,11267066,11530571,11617389,11814973,12011946,12084655,12285644,12372494,12414939,12926968,12956052,13202590,13823883,13938724,13955260,13988109,14062168,14148205,14385245,14395504,14534000,14671329,15639564,15795612,15831048,15840470,15915111,16184706,16223058,16273678,16384427,16464249,16578216,16588794,16696265,16952627,17387979,17422278,17544435,17861364,18140785,18443615,18601061,18756993,18787645,18874276,19200180,19457772,19533769,19557345,19613767,19700790,19782902,19947286,20283372,20617878,20658703,20934707,21160142,21232710,21249586,21415825,21435581,21616835,21663663,21743445,21761849,22519985,22542942,22584238,22666420,22682946,22691984,22739509,23341180,23406739,23660859,23679600,23930639,23986040,24031643,24062304,24160444,24403148,24964658,25210874,25211347,25265847,25297013,25360511,25566304,25633751,26037257,26051940,26183490,26299482,26341492,26359016,26410127,26797389,26954938,27048844,27221870,27396031,27667930,27682935,27692016,27729621,28072526,28453744,28543628,29139345,29149361,29169171,29313135,29411594,29597612,29668832,29790728,29818178,29842091,30136118,30224730,30416453,30477785,30566591,30649339,30693676,30832210,30840682,30963999,31011581,31028728,31126573,31251788,31570036,31609446,31786814,31962949,31984465,32285180,32324152,32446063,32452510,32522692,32534927,32710344,32714867,33093774,33098354,33176109,33506602,33529736,33605139,33721002,33743060,33832748,34112810,34376447,34423517,34455384,34574477,34575648,34621690,35216133,35249783,35811456,35932904,36073686,36171692,36373663,36405138,36440703,36868781,36956622,37012089,37015421,37044830,37092024,37136990,37278168,37368674,37386443,37641990,37702078,37776174,37901571,38236739,38257253,38327251,38651536,38723725,38934148,39120587,39208329,39395659,39599651,39671852,39856353,39864295,39910967,39977973,40050521,40132610,40335689,40367309,40542626,40736514,40813524,40825464,40963516,41063137,41067576,41114471,41115444,41481803,41737893,41809552,41812258,41865284,42078133,42187180,42253098,42301905,42316411,42416986,42464221,42611016,42753376,42754141,42822777,43126362,43190378,43258005,43301459,43352765,43589836,43866704,44017971,44118825,44231990,44245787,44259757,44282517,44439069,44470955,44506576,44787113,44890983,44915114,44950878,45075646,45199500,45379089,45473920,45542574,45772224,45910474,46025406,46055324,46453711,46588323,46716815,46802702,47259470,47271897,47368258,47667333,48023108,48849217,48899229,49042192,49205358,49331559,49477991,49572152,49588583,49777371,50072344,50252930,50319225,50396724,50516856,50942446,51023803,52095287,52175721,52241107,52268202,52333556,52454084,52615771,52671874,52809388,52962433,52970381,53162961,53456077,53580299,53587489,53634984,53803910,54129165,54269031,54384445,54491356,54975729,55005854,55553167,55553620,55682960,55688314,55708604,55845564,55981574,560006,2543357,2923021,4209637,4608989,4645552,5370006,5731533,5763969,5866205,6049311,6296603,6342311,7168985,7258784,8136851,8166211,8577641,8615751,8620362,8717383,9113266,9148954,9570292,9584654,9603211,9733686,9920124,10138018,10160317,10270526,10280163,10663878,10844889,10853256,10869600,11069963,11131801,11158889,11310902,11369081,11402943,11523531,11697562,11725088,11834538,11992159,12085902,12376115,12444134,12575319,12597907,12612197,12656440,12952985,13412270,13490333,13510414,13667934,13744466,13773615,13794975,13797038,13899297,14027481,14110654,14176330,14183626,14330893,14358801,14558540,14656445,15200344,15226559,15244655,15559352,15616641,15617490,16356199,16587759,16708712,16939962,17268172,17596672,17659899,17831915,17944769,18054342,18078475,18176414,18365444,18374687,18403272,18443074,18518457,18635859,18653838,18670979,18931196,19175086,19269519,19383046,19503164,19533315,19558303,20299372,20355839,20398666,20416228,20662767,20815209,20841187,20901037,20923857,20965305,21162679,21221088,21281413,21368011,21384042,21496496,21810409,21945515,21963433,22070320,22268246,22701950,22763803,22809006,22979262,23005376,23087549,23125714,23152151,23184349,23221007,23445771,23457635,23520357,23571630,23789009,24150475,24261462,24321596,24788996,25115125,25118473,25192607,25346470,25517475,25949661,26113084,26266467,26278551,26334185,26374342,26534852,26651951,26670820,26703817,26706398,26807873,26933338,27149731,27236117,27366112,27417444,27538754,27559665,27595376,27616741,28002960,28250239,28259162,28347534,28486803,28561949,28566489,28806923,28895316,28977351,29050054,29175115,29220691,29308493,29507856,29545290,29643329,29730724,29749514,29788591,29795883,29805588,29810469,29873578,29929794,30045992,30253998,30352849,30551522,30613660,30686992,30850186,30955983,31104351,31243894,31427338,31653048,31653245,31676282,31766828,31804269,31976242,32167419,32178820,32204414,32209194,32269519,32275512,32319331,32393698,32427093,32541239,32617585,32642851,32672253,32942720,33143268,33187247,33256288,33366449,33494987,33552216,33586638,33590305,33591961,33618191,33681376,34060235,34466982,34557712,34702666,34708387,34868195,35252575,35332020,35497946,35497964,35549533,35693264,35914650,35976603,36053385,36092565,36338432,36373533,36512049,36523132,36564434,36601166,36735910,36846085,37370249,37617173,37666061,37684436,37765135,37816976,38238363,38300115,38334747,38671182,38681418,38843217,38904362,38904362,39037928,39233138,39268432,39427521,39439365,39462048,39784610,39997099,40015644,40125057,40217754,40237594,40313481,40471235,40519783,40526356,40611808,40704077,40828270,40977348,41286761,41313003,41563895,41563897,41821924,41843713,42060276,42250978,42976849,43112609,43254482,43359649,43427889,43628193,43887920,44232400,44679028,45118268,45197334,45250051,45258819,45432641,45540503,45667987,45667987,45726250,45736085,45760861,45781647,45893780,46094215,46207138,46260542,46277144,46343211,46649922,46680080,46916086,46987326,47141031,47473010,47478820,47660583,47902521,47955507,48006836,48019234,48132069,48149583,48445377,48448588,48982124,49001465,49230344,49624362,49657185,49803385,49829237,50037914,50079226,50273502,50508946,50523918,50643390,39233138,50923433,51448369,51645541,51692602,51980772,52038658,52143991,52306255,52791021,52900023,52942822,53569543,53993132,54178741,54618631,55063368,55475988,55528673,55601087,55865385,55868868,514517,1318955,1460531,1582903,1721911,3086406,3272126,3275379,3490999,3498816,4291761,4315367,4430047,4531464,5147430,5239735,5299411,5761842,6632209,7234654,7643008,7896397,8037122,8048636,8218524,8279939,8696030,9196192,9660168,10055551,10352231,10895018,11061143,11266091,11456310,11620982,11709155,11727032,11732184,11830636,11938690,12180861,12219643,12509737,12631280,12775631,13168163,13363666,13401681,13607810,13673381,13673381,14090649,14295201,14299498,14833921,15062297,15247892,15310530,15376996,15498722,15901591,15913821,16148101,16523245,16575426,16621809,16849913,16912368,17065946,17249470,17533368,17558331,17750618,17823100,17892107,17955511,18114286,18266011,18277576,20041558,20067797,20226848,20248588,20387055,20413155,20578963,20587235,20597704,20692655,20835681,21396800,21459305,21505671,21756392,21963319,22030553,22089094,22119882,22155631,22392071,22430939,22555650,23094548,23292037,23462834,23607026,23618258,23857995,24032220,24164199,24339850,24445163,24487545,24704262,25371794,25957993,26133705,26321860,26351539,26607409,26783818,26797049,27141186,27297618,27532110,27537995,27553766,27577280,27620077,27651724,27765983,28231279,28357108,28382894,28467274,28726502,29019131,29203801,29214653,29236493,29504539,29716191,29723153,29805223,30465037,30881191,30960635,31650184,31708000,31745480,31826470,32353429,32502630,32675997,32770815,32771266,32918963,33072851,33148867,33602297,33641677,33643311,33747984,33770290,33792425,33838178,33919877,34120216,34220750,34241421,34249550,34598078,34643059,34648570,34938619,34966098,35138755,35560225,35823736,35842942,35889474,35926129,35971935,35995971,36022198,36432392,36432553,36924731,37086470,37092427,37118651,37264012,37483528,37704902,37714318,37727402,38049902,38063143,38086081,38110852,38313839,38334528,38504255,38672135,38891160,39040543,39139491,39183501,39237587,39402720,39551445,39813738,39951997,40033661,40040701,40171820,40235863,40267509,40310563,40345985,40372658,40425316,40454158,40855794,40960619,41048353,41048965,41629983,42247551,42285669,42306581,42650360,42771800,42880771,42981575,43017368,43169475,43174426,43196972,43311175,43461724,43518846,43662415,43724721,43964137,44005916,44139492,44157398,44573866,44587005,44628721,44629671,44699412,44810010,44922210,45007179,45125055,45192155,45195931,45240804,45538009,45610309,45702529,45789765,45837544,45872547,45907214,45964421,46127745,46215793,46520070,46582357,46651492,46674148,46787348,46870164,47046198,47092339,47146119,47197865,47242304,47242896,47539689,47570669,47657146,47738713,47930656,48023926,48050732,48253529,48277470,48424108,48488955,48498763,48530763,48568006,48597015,48784646,49063612,49072401,49137865,49194724,49612466,49712373,49767831,49801154,49807694,49808459,49808855,50032469,50198000,50383046,50468424,50543293,50665718,50823355,50828912,50912438,50959129,50976737,51045526,51064565,51087761,51092254,51191109,51217365,51368086,51406614,51440674,51514862,51523332,51750300,51788805,51846665,51851722,51971005,52022412,52100343,52127982,52137676,52153588,52288027,52329084,52385326,52413499,52467937,52560553,52751945,52829505,52975797,52988925,53142133,53227287,53312361,53420325,53474179,53530646,53540698,53568218,53806369,53986971,54033878,54117000,54303414,54323332,54355276,54901809,54918427,54996120,55008623,55069962,55165291,55352817,55756492,55820395,55843569,55844698,55944669,56169081,56341879,56403974,361158,1606967,1727150,1938319,1947343,2015329,2116999,2182488,2563426,2604454,2859362,3360387,3439495,3654309,4126533,4168659,4217452,4325585,4379154,4556879,4684900,4694816,4777541,4988445,5013708,5115995,5135509,5169321,5453261,5767092,5889651,6148209,6254602,6870575,7493521,8142097,8155443,8197624,8261392,8273826,8283470,8299499,8537652,8623341,8717759,8946209,8974368,9254988,9262981,9267268,9509032,9798430,9818245,9925196,10002805,10087552,10158545,10246492,10341595,10879118,10985461,10994146,11152781,11183232,11384073,11468529,11545703,11623633,11682656,11741915,11801725,11815880,11826470,12065201,12113136,12330345,12341744,12559448,12760132,12911772,12960000,12973748,13050303,13310791,13316398,13386360,13548302,13646997,13988418,14183099,14246712,14319623,14336386,14377232,14384225,14435255,14505065,14540400,14625227,14716556,14902902,14951869,15040541,15127813,15262932,15275622,15563455,15595034,15618861,15640688,15678836,15849329,16058967,16063924,16152352,16605563,16623428,16675998,16708675,16726135,17031532,17135768,17212266,17253665,17374352,17403187,17799399,17808106,17867875,17994028,18344018,18382681,19045774,19097179,19098833,19263216,19443594,19694159,19700238,19732758,20424188,20517410,20542629,20552569,21195919,21260669,21642984,21661883,21751376,21892282,22013847,22303390,22335133,22395788,22443141,22507973,22540389,22598814,22628009,22648500,23397767,23428647,23429229,23475753,23627409,23675576,23845349,23929136,24082528,24136031,24534339,24617748,24703200,24714459,24741513,24861566,24973371,25084373,25283650,25447101,25547280,25548715,25618303,26175327,26227896,26254861,26304744,26422593,26548074,26612264,26798022,26908353,26923279,27088557,27173543,27240944,27251625,27536719,27646170,27816725,28015389,28050921,28080459,28131480,28335740,28362194,28456193,28786403,28824504,28972885,29067911,29208158,29534808,29625108,29893244,29942398,30305493,30446432,30458638,31014364,31212242,31240497,31248225,31449102,31714336,31745553,31809481,31863695,32080037,32207358,32248981,32805259,32843260,32935102,33064890,33191679,33219006,33444867,33476734,33627839,33657815,33666531,33851640,33971929,34037428,34069130,34073927,34181379,34195196,34266530,34408681,34445236,34510608,34558760,34589083,34759591,35020809,35308527,35372103,35403389,35510889,35560590,35590767,35590767,35599495,35612690,35648172,35693578,35746396,35921671,36163352,36188657,36205392,36264688,36301610,36323513,36900249,37187703,37540031,37965678,38246557,38251855,38518129,38547346,38763036,38820880,38895360,39026239,39075574,39151637,39249372,39455641,39509953,39562935,39657730,39697649,39763827,39766730,40001644,40024330,40235904,40247568,40623299,40883247,41078076,41271166,41302883,41373257,41555552,41806935,41817966,41916833,42136728,42577798,42745733,42815555,42957683,43123967,43127565,43414677,43416996,44037321,44066476,44082117,44216536,44328262,44478159,44677700,44811535,44911113,45503027,45545901,45565196,45732890,45972454,46300143,46531352,46594126,46704641,47052559,47091110,47100316,47141669,47307533,47460589,47550143,47732187,47771377,47869082,47991819,48161594,48201601,48539665,48562953,48863574,49222391,49239091,49587665,49643201,49806413,49994300,50000804,50808175,51199783,51319585,51936077,52338027,52341611,52464631,52607832,52753839,52941625,54365760,54409153,54808259,55010830,55053845,55110864,55327050,55792385,55988793,56378053);",
        conn, parse_dates={"CreationDate": "%Y-%m-%d %H:%M:%S"})
    df_comments = pd.read_sql_query(
        "SELECT * FROM EditHistory_Code WHERE Event = 'Comment' AND PostId IN (818313,939060,1417254,1276894,1804490,2061144,2256556,3366318,3347598,3383237,4040641,4323607,4357318,4605982,5112457,5326382,5553947,6330456,6872517,6954573,7271326,7498411,6908115,7891698,8203073,9043462,9236878,9239808,9397206,9556452,9630432,9686046,10060390,10150458,2206432,10284119,10343816,10374564,10405545,10498341,10547344,11020094,11217492,11649404,11847167,11884184,12002701,12024009,12154831,12242834,12452881,12586471,12638451,12836218,12892964,13039557,13479302,13594807,13608535,13636838,13675924,13703279,13821778,14146919,14274978,14499028,14778058,14861957,15013259,15030050,15555250,15795118,15801490,15762726,15836989,15883604,15957975,15976303,15984885,16251905,16346563,16433740,7080110,17057187,17191396,17319638,17534943,17599402,17761938,17829520,17890507,17913039,18048949,18194951,18243157,18443074,18493467,18505187,18894906,19120443,19170570,19345640,19941171,20051167,20281502,20389922,20522648,20564980,20643356,20682670,20830515,20979166,20982407,21051450,21221088,21397451,21467987,21508484,21563424,21574754,21546112,21900743,21928787,22244318,19760247,22453634,22547276,22558242,22632211,22719774,22729235,22755610,22790433,22801381,22815825,23047291,23485518,23596935,23746834,23836513,23966454,23966579,24053116,24097089,24097395,24112752,24222260,24261239,24354619,24374760,24466679,24527796,13490879,24711801,24994747,25048956,25213188,25363478,25478667,25567294,25570082,25722877,25941522,26128045,26131972,26166810,26275516,26464722,22840483,26575292,26684874,26707401,26742187,26743196,26875502,26895625,26963815,26996935,27129527,27249942,27300544,27460666,27467436,27598202,28161001,28246170,28372662,28567081,28759071,29019668,29059351,29065976,21757928,4903603,29497063,29590346,29690325,29787277,29720760,29811000,29990543,30006033,30006383,30007770,30030466,30040186,30065760,30199210,30279363,30511497,30866171,30994088,31392227,31494182,31545286,31799561,31874400,32236521,32545385,32749983,32754922,33075045,33114312,33191611,33776967,34629675,35004710,35739045,35743682,35890604,36269980,36320155,36486897,36565615,36608850,37012846,37066827,37173859,37285008,37339594,37318859,37453268,37508304,37697179,37762134,37769932,37992391,38024945,38037269,38400960,38536173,38587221,38667012,38699205,33437366,38783706,35219474,38824811,39167699,39220959,39281965,39566876,39569666,39706712,39796059,40096675,40164633,40201740,21970805,40440530,40474532,40605034,41083139,41462630,6667403,41568370,41609515,41662470,41761656,41770767,41843713,42374536,42464496,42469760,42505230,42525241,42666184,42722091,42745270,42842593,43100605,43136269,43279035,43280212,43361112,43511213,43642366,27506104,43770851,43835126,43875064,44364052,44398934,44405921,44460065,45111288,45337346,45488299,45857726,45720860,46393474,46428741,46671750,46675245,46770584,46911175,47104641,47406508,47415643,47545712,47582363,47743840,47818939,47845637,48210898,48391112,48417942,48430421,48445377,48608229,48909781,49054649,49060906,27173320,49324753,49488361,49556258,49594320,49605667,49611325,49879709,49876892,50064265,50085689,50107889,50153682,50196591,50328445,50416883,50401250,50547398,50942905,51537352,51664465,52098233,52172471,52324512,52466191,52517618,52524114,52879125,52980017,53062115,53175054,53216022,53354155,53644456,53692842,53708081,53830302,53852343,53927692,54615947,54892387,54886614,55117356,55652916,55788001,55855047,55879567,55884358,55957419,7875,1757843,2486471,2494473,2550109,2861345,2901136,2931250,3180655,3359695,3517919,3835837,3941993,3998810,4002998,4067488,4132683,4221530,4324452,4528579,4769473,4812456,4941028,4942094,5518611,5586896,5616616,6010680,6722434,7008045,7078376,7126108,7235584,7460596,7499793,7544391,7936715,7947296,7967539,8037909,8253636,8329078,8365193,8525234,8832616,8961590,9247380,9575427,9671062,9756189,9765719,9842690,9946432,9967906,10002834,10059880,10261872,10270684,10273530,10457243,10474157,10575359,10675391,10986507,11013401,11100438,11261905,11267066,11530571,11617389,11814973,12011946,12084655,12285644,12372494,12414939,12926968,12956052,13202590,13823883,13938724,13955260,13988109,14062168,14148205,14385245,14395504,14534000,14671329,15639564,15795612,15831048,15840470,15915111,16184706,16223058,16273678,16384427,16464249,16578216,16588794,16696265,16952627,17387979,17422278,17544435,17861364,18140785,18443615,18601061,18756993,18787645,18874276,19200180,19457772,19533769,19557345,19613767,19700790,19782902,19947286,20283372,20617878,20658703,20934707,21160142,21232710,21249586,21415825,21435581,21616835,21663663,21743445,21761849,22519985,22542942,22584238,22666420,22682946,22691984,22739509,23341180,23406739,23660859,23679600,23930639,23986040,24031643,24062304,24160444,24403148,24964658,25210874,25211347,25265847,25297013,25360511,25566304,25633751,26037257,26051940,26183490,26299482,26341492,26359016,26410127,26797389,26954938,27048844,27221870,27396031,27667930,27682935,27692016,27729621,28072526,28453744,28543628,29139345,29149361,29169171,29313135,29411594,29597612,29668832,29790728,29818178,29842091,30136118,30224730,30416453,30477785,30566591,30649339,30693676,30832210,30840682,30963999,31011581,31028728,31126573,31251788,31570036,31609446,31786814,31962949,31984465,32285180,32324152,32446063,32452510,32522692,32534927,32710344,32714867,33093774,33098354,33176109,33506602,33529736,33605139,33721002,33743060,33832748,34112810,34376447,34423517,34455384,34574477,34575648,34621690,35216133,35249783,35811456,35932904,36073686,36171692,36373663,36405138,36440703,36868781,36956622,37012089,37015421,37044830,37092024,37136990,37278168,37368674,37386443,37641990,37702078,37776174,37901571,38236739,38257253,38327251,38651536,38723725,38934148,39120587,39208329,39395659,39599651,39671852,39856353,39864295,39910967,39977973,40050521,40132610,40335689,40367309,40542626,40736514,40813524,40825464,40963516,41063137,41067576,41114471,41115444,41481803,41737893,41809552,41812258,41865284,42078133,42187180,42253098,42301905,42316411,42416986,42464221,42611016,42753376,42754141,42822777,43126362,43190378,43258005,43301459,43352765,43589836,43866704,44017971,44118825,44231990,44245787,44259757,44282517,44439069,44470955,44506576,44787113,44890983,44915114,44950878,45075646,45199500,45379089,45473920,45542574,45772224,45910474,46025406,46055324,46453711,46588323,46716815,46802702,47259470,47271897,47368258,47667333,48023108,48849217,48899229,49042192,49205358,49331559,49477991,49572152,49588583,49777371,50072344,50252930,50319225,50396724,50516856,50942446,51023803,52095287,52175721,52241107,52268202,52333556,52454084,52615771,52671874,52809388,52962433,52970381,53162961,53456077,53580299,53587489,53634984,53803910,54129165,54269031,54384445,54491356,54975729,55005854,55553167,55553620,55682960,55688314,55708604,55845564,55981574,560006,2543357,2923021,4209637,4608989,4645552,5370006,5731533,5763969,5866205,6049311,6296603,6342311,7168985,7258784,8136851,8166211,8577641,8615751,8620362,8717383,9113266,9148954,9570292,9584654,9603211,9733686,9920124,10138018,10160317,10270526,10280163,10663878,10844889,10853256,10869600,11069963,11131801,11158889,11310902,11369081,11402943,11523531,11697562,11725088,11834538,11992159,12085902,12376115,12444134,12575319,12597907,12612197,12656440,12952985,13412270,13490333,13510414,13667934,13744466,13773615,13794975,13797038,13899297,14027481,14110654,14176330,14183626,14330893,14358801,14558540,14656445,15200344,15226559,15244655,15559352,15616641,15617490,16356199,16587759,16708712,16939962,17268172,17596672,17659899,17831915,17944769,18054342,18078475,18176414,18365444,18374687,18403272,18443074,18518457,18635859,18653838,18670979,18931196,19175086,19269519,19383046,19503164,19533315,19558303,20299372,20355839,20398666,20416228,20662767,20815209,20841187,20901037,20923857,20965305,21162679,21221088,21281413,21368011,21384042,21496496,21810409,21945515,21963433,22070320,22268246,22701950,22763803,22809006,22979262,23005376,23087549,23125714,23152151,23184349,23221007,23445771,23457635,23520357,23571630,23789009,24150475,24261462,24321596,24788996,25115125,25118473,25192607,25346470,25517475,25949661,26113084,26266467,26278551,26334185,26374342,26534852,26651951,26670820,26703817,26706398,26807873,26933338,27149731,27236117,27366112,27417444,27538754,27559665,27595376,27616741,28002960,28250239,28259162,28347534,28486803,28561949,28566489,28806923,28895316,28977351,29050054,29175115,29220691,29308493,29507856,29545290,29643329,29730724,29749514,29788591,29795883,29805588,29810469,29873578,29929794,30045992,30253998,30352849,30551522,30613660,30686992,30850186,30955983,31104351,31243894,31427338,31653048,31653245,31676282,31766828,31804269,31976242,32167419,32178820,32204414,32209194,32269519,32275512,32319331,32393698,32427093,32541239,32617585,32642851,32672253,32942720,33143268,33187247,33256288,33366449,33494987,33552216,33586638,33590305,33591961,33618191,33681376,34060235,34466982,34557712,34702666,34708387,34868195,35252575,35332020,35497946,35497964,35549533,35693264,35914650,35976603,36053385,36092565,36338432,36373533,36512049,36523132,36564434,36601166,36735910,36846085,37370249,37617173,37666061,37684436,37765135,37816976,38238363,38300115,38334747,38671182,38681418,38843217,38904362,38904362,39037928,39233138,39268432,39427521,39439365,39462048,39784610,39997099,40015644,40125057,40217754,40237594,40313481,40471235,40519783,40526356,40611808,40704077,40828270,40977348,41286761,41313003,41563895,41563897,41821924,41843713,42060276,42250978,42976849,43112609,43254482,43359649,43427889,43628193,43887920,44232400,44679028,45118268,45197334,45250051,45258819,45432641,45540503,45667987,45667987,45726250,45736085,45760861,45781647,45893780,46094215,46207138,46260542,46277144,46343211,46649922,46680080,46916086,46987326,47141031,47473010,47478820,47660583,47902521,47955507,48006836,48019234,48132069,48149583,48445377,48448588,48982124,49001465,49230344,49624362,49657185,49803385,49829237,50037914,50079226,50273502,50508946,50523918,50643390,39233138,50923433,51448369,51645541,51692602,51980772,52038658,52143991,52306255,52791021,52900023,52942822,53569543,53993132,54178741,54618631,55063368,55475988,55528673,55601087,55865385,55868868,514517,1318955,1460531,1582903,1721911,3086406,3272126,3275379,3490999,3498816,4291761,4315367,4430047,4531464,5147430,5239735,5299411,5761842,6632209,7234654,7643008,7896397,8037122,8048636,8218524,8279939,8696030,9196192,9660168,10055551,10352231,10895018,11061143,11266091,11456310,11620982,11709155,11727032,11732184,11830636,11938690,12180861,12219643,12509737,12631280,12775631,13168163,13363666,13401681,13607810,13673381,13673381,14090649,14295201,14299498,14833921,15062297,15247892,15310530,15376996,15498722,15901591,15913821,16148101,16523245,16575426,16621809,16849913,16912368,17065946,17249470,17533368,17558331,17750618,17823100,17892107,17955511,18114286,18266011,18277576,20041558,20067797,20226848,20248588,20387055,20413155,20578963,20587235,20597704,20692655,20835681,21396800,21459305,21505671,21756392,21963319,22030553,22089094,22119882,22155631,22392071,22430939,22555650,23094548,23292037,23462834,23607026,23618258,23857995,24032220,24164199,24339850,24445163,24487545,24704262,25371794,25957993,26133705,26321860,26351539,26607409,26783818,26797049,27141186,27297618,27532110,27537995,27553766,27577280,27620077,27651724,27765983,28231279,28357108,28382894,28467274,28726502,29019131,29203801,29214653,29236493,29504539,29716191,29723153,29805223,30465037,30881191,30960635,31650184,31708000,31745480,31826470,32353429,32502630,32675997,32770815,32771266,32918963,33072851,33148867,33602297,33641677,33643311,33747984,33770290,33792425,33838178,33919877,34120216,34220750,34241421,34249550,34598078,34643059,34648570,34938619,34966098,35138755,35560225,35823736,35842942,35889474,35926129,35971935,35995971,36022198,36432392,36432553,36924731,37086470,37092427,37118651,37264012,37483528,37704902,37714318,37727402,38049902,38063143,38086081,38110852,38313839,38334528,38504255,38672135,38891160,39040543,39139491,39183501,39237587,39402720,39551445,39813738,39951997,40033661,40040701,40171820,40235863,40267509,40310563,40345985,40372658,40425316,40454158,40855794,40960619,41048353,41048965,41629983,42247551,42285669,42306581,42650360,42771800,42880771,42981575,43017368,43169475,43174426,43196972,43311175,43461724,43518846,43662415,43724721,43964137,44005916,44139492,44157398,44573866,44587005,44628721,44629671,44699412,44810010,44922210,45007179,45125055,45192155,45195931,45240804,45538009,45610309,45702529,45789765,45837544,45872547,45907214,45964421,46127745,46215793,46520070,46582357,46651492,46674148,46787348,46870164,47046198,47092339,47146119,47197865,47242304,47242896,47539689,47570669,47657146,47738713,47930656,48023926,48050732,48253529,48277470,48424108,48488955,48498763,48530763,48568006,48597015,48784646,49063612,49072401,49137865,49194724,49612466,49712373,49767831,49801154,49807694,49808459,49808855,50032469,50198000,50383046,50468424,50543293,50665718,50823355,50828912,50912438,50959129,50976737,51045526,51064565,51087761,51092254,51191109,51217365,51368086,51406614,51440674,51514862,51523332,51750300,51788805,51846665,51851722,51971005,52022412,52100343,52127982,52137676,52153588,52288027,52329084,52385326,52413499,52467937,52560553,52751945,52829505,52975797,52988925,53142133,53227287,53312361,53420325,53474179,53530646,53540698,53568218,53806369,53986971,54033878,54117000,54303414,54323332,54355276,54901809,54918427,54996120,55008623,55069962,55165291,55352817,55756492,55820395,55843569,55844698,55944669,56169081,56341879,56403974,361158,1606967,1727150,1938319,1947343,2015329,2116999,2182488,2563426,2604454,2859362,3360387,3439495,3654309,4126533,4168659,4217452,4325585,4379154,4556879,4684900,4694816,4777541,4988445,5013708,5115995,5135509,5169321,5453261,5767092,5889651,6148209,6254602,6870575,7493521,8142097,8155443,8197624,8261392,8273826,8283470,8299499,8537652,8623341,8717759,8946209,8974368,9254988,9262981,9267268,9509032,9798430,9818245,9925196,10002805,10087552,10158545,10246492,10341595,10879118,10985461,10994146,11152781,11183232,11384073,11468529,11545703,11623633,11682656,11741915,11801725,11815880,11826470,12065201,12113136,12330345,12341744,12559448,12760132,12911772,12960000,12973748,13050303,13310791,13316398,13386360,13548302,13646997,13988418,14183099,14246712,14319623,14336386,14377232,14384225,14435255,14505065,14540400,14625227,14716556,14902902,14951869,15040541,15127813,15262932,15275622,15563455,15595034,15618861,15640688,15678836,15849329,16058967,16063924,16152352,16605563,16623428,16675998,16708675,16726135,17031532,17135768,17212266,17253665,17374352,17403187,17799399,17808106,17867875,17994028,18344018,18382681,19045774,19097179,19098833,19263216,19443594,19694159,19700238,19732758,20424188,20517410,20542629,20552569,21195919,21260669,21642984,21661883,21751376,21892282,22013847,22303390,22335133,22395788,22443141,22507973,22540389,22598814,22628009,22648500,23397767,23428647,23429229,23475753,23627409,23675576,23845349,23929136,24082528,24136031,24534339,24617748,24703200,24714459,24741513,24861566,24973371,25084373,25283650,25447101,25547280,25548715,25618303,26175327,26227896,26254861,26304744,26422593,26548074,26612264,26798022,26908353,26923279,27088557,27173543,27240944,27251625,27536719,27646170,27816725,28015389,28050921,28080459,28131480,28335740,28362194,28456193,28786403,28824504,28972885,29067911,29208158,29534808,29625108,29893244,29942398,30305493,30446432,30458638,31014364,31212242,31240497,31248225,31449102,31714336,31745553,31809481,31863695,32080037,32207358,32248981,32805259,32843260,32935102,33064890,33191679,33219006,33444867,33476734,33627839,33657815,33666531,33851640,33971929,34037428,34069130,34073927,34181379,34195196,34266530,34408681,34445236,34510608,34558760,34589083,34759591,35020809,35308527,35372103,35403389,35510889,35560590,35590767,35590767,35599495,35612690,35648172,35693578,35746396,35921671,36163352,36188657,36205392,36264688,36301610,36323513,36900249,37187703,37540031,37965678,38246557,38251855,38518129,38547346,38763036,38820880,38895360,39026239,39075574,39151637,39249372,39455641,39509953,39562935,39657730,39697649,39763827,39766730,40001644,40024330,40235904,40247568,40623299,40883247,41078076,41271166,41302883,41373257,41555552,41806935,41817966,41916833,42136728,42577798,42745733,42815555,42957683,43123967,43127565,43414677,43416996,44037321,44066476,44082117,44216536,44328262,44478159,44677700,44811535,44911113,45503027,45545901,45565196,45732890,45972454,46300143,46531352,46594126,46704641,47052559,47091110,47100316,47141669,47307533,47460589,47550143,47732187,47771377,47869082,47991819,48161594,48201601,48539665,48562953,48863574,49222391,49239091,49587665,49643201,49806413,49994300,50000804,50808175,51199783,51319585,51936077,52338027,52341611,52464631,52607832,52753839,52941625,54365760,54409153,54808259,55010830,55053845,55110864,55327050,55792385,55988793,56378053);",
        conn, parse_dates={"CreationDate": "%Y-%m-%d %H:%M:%S"})
    df_edits = pd.read_sql_query(
        "SELECT * FROM EditHistory_Code WHERE Event = 'BodyEdit' AND PostId IN (818313,939060,1417254,1276894,1804490,2061144,2256556,3366318,3347598,3383237,4040641,4323607,4357318,4605982,5112457,5326382,5553947,6330456,6872517,6954573,7271326,7498411,6908115,7891698,8203073,9043462,9236878,9239808,9397206,9556452,9630432,9686046,10060390,10150458,2206432,10284119,10343816,10374564,10405545,10498341,10547344,11020094,11217492,11649404,11847167,11884184,12002701,12024009,12154831,12242834,12452881,12586471,12638451,12836218,12892964,13039557,13479302,13594807,13608535,13636838,13675924,13703279,13821778,14146919,14274978,14499028,14778058,14861957,15013259,15030050,15555250,15795118,15801490,15762726,15836989,15883604,15957975,15976303,15984885,16251905,16346563,16433740,7080110,17057187,17191396,17319638,17534943,17599402,17761938,17829520,17890507,17913039,18048949,18194951,18243157,18443074,18493467,18505187,18894906,19120443,19170570,19345640,19941171,20051167,20281502,20389922,20522648,20564980,20643356,20682670,20830515,20979166,20982407,21051450,21221088,21397451,21467987,21508484,21563424,21574754,21546112,21900743,21928787,22244318,19760247,22453634,22547276,22558242,22632211,22719774,22729235,22755610,22790433,22801381,22815825,23047291,23485518,23596935,23746834,23836513,23966454,23966579,24053116,24097089,24097395,24112752,24222260,24261239,24354619,24374760,24466679,24527796,13490879,24711801,24994747,25048956,25213188,25363478,25478667,25567294,25570082,25722877,25941522,26128045,26131972,26166810,26275516,26464722,22840483,26575292,26684874,26707401,26742187,26743196,26875502,26895625,26963815,26996935,27129527,27249942,27300544,27460666,27467436,27598202,28161001,28246170,28372662,28567081,28759071,29019668,29059351,29065976,21757928,4903603,29497063,29590346,29690325,29787277,29720760,29811000,29990543,30006033,30006383,30007770,30030466,30040186,30065760,30199210,30279363,30511497,30866171,30994088,31392227,31494182,31545286,31799561,31874400,32236521,32545385,32749983,32754922,33075045,33114312,33191611,33776967,34629675,35004710,35739045,35743682,35890604,36269980,36320155,36486897,36565615,36608850,37012846,37066827,37173859,37285008,37339594,37318859,37453268,37508304,37697179,37762134,37769932,37992391,38024945,38037269,38400960,38536173,38587221,38667012,38699205,33437366,38783706,35219474,38824811,39167699,39220959,39281965,39566876,39569666,39706712,39796059,40096675,40164633,40201740,21970805,40440530,40474532,40605034,41083139,41462630,6667403,41568370,41609515,41662470,41761656,41770767,41843713,42374536,42464496,42469760,42505230,42525241,42666184,42722091,42745270,42842593,43100605,43136269,43279035,43280212,43361112,43511213,43642366,27506104,43770851,43835126,43875064,44364052,44398934,44405921,44460065,45111288,45337346,45488299,45857726,45720860,46393474,46428741,46671750,46675245,46770584,46911175,47104641,47406508,47415643,47545712,47582363,47743840,47818939,47845637,48210898,48391112,48417942,48430421,48445377,48608229,48909781,49054649,49060906,27173320,49324753,49488361,49556258,49594320,49605667,49611325,49879709,49876892,50064265,50085689,50107889,50153682,50196591,50328445,50416883,50401250,50547398,50942905,51537352,51664465,52098233,52172471,52324512,52466191,52517618,52524114,52879125,52980017,53062115,53175054,53216022,53354155,53644456,53692842,53708081,53830302,53852343,53927692,54615947,54892387,54886614,55117356,55652916,55788001,55855047,55879567,55884358,55957419,7875,1757843,2486471,2494473,2550109,2861345,2901136,2931250,3180655,3359695,3517919,3835837,3941993,3998810,4002998,4067488,4132683,4221530,4324452,4528579,4769473,4812456,4941028,4942094,5518611,5586896,5616616,6010680,6722434,7008045,7078376,7126108,7235584,7460596,7499793,7544391,7936715,7947296,7967539,8037909,8253636,8329078,8365193,8525234,8832616,8961590,9247380,9575427,9671062,9756189,9765719,9842690,9946432,9967906,10002834,10059880,10261872,10270684,10273530,10457243,10474157,10575359,10675391,10986507,11013401,11100438,11261905,11267066,11530571,11617389,11814973,12011946,12084655,12285644,12372494,12414939,12926968,12956052,13202590,13823883,13938724,13955260,13988109,14062168,14148205,14385245,14395504,14534000,14671329,15639564,15795612,15831048,15840470,15915111,16184706,16223058,16273678,16384427,16464249,16578216,16588794,16696265,16952627,17387979,17422278,17544435,17861364,18140785,18443615,18601061,18756993,18787645,18874276,19200180,19457772,19533769,19557345,19613767,19700790,19782902,19947286,20283372,20617878,20658703,20934707,21160142,21232710,21249586,21415825,21435581,21616835,21663663,21743445,21761849,22519985,22542942,22584238,22666420,22682946,22691984,22739509,23341180,23406739,23660859,23679600,23930639,23986040,24031643,24062304,24160444,24403148,24964658,25210874,25211347,25265847,25297013,25360511,25566304,25633751,26037257,26051940,26183490,26299482,26341492,26359016,26410127,26797389,26954938,27048844,27221870,27396031,27667930,27682935,27692016,27729621,28072526,28453744,28543628,29139345,29149361,29169171,29313135,29411594,29597612,29668832,29790728,29818178,29842091,30136118,30224730,30416453,30477785,30566591,30649339,30693676,30832210,30840682,30963999,31011581,31028728,31126573,31251788,31570036,31609446,31786814,31962949,31984465,32285180,32324152,32446063,32452510,32522692,32534927,32710344,32714867,33093774,33098354,33176109,33506602,33529736,33605139,33721002,33743060,33832748,34112810,34376447,34423517,34455384,34574477,34575648,34621690,35216133,35249783,35811456,35932904,36073686,36171692,36373663,36405138,36440703,36868781,36956622,37012089,37015421,37044830,37092024,37136990,37278168,37368674,37386443,37641990,37702078,37776174,37901571,38236739,38257253,38327251,38651536,38723725,38934148,39120587,39208329,39395659,39599651,39671852,39856353,39864295,39910967,39977973,40050521,40132610,40335689,40367309,40542626,40736514,40813524,40825464,40963516,41063137,41067576,41114471,41115444,41481803,41737893,41809552,41812258,41865284,42078133,42187180,42253098,42301905,42316411,42416986,42464221,42611016,42753376,42754141,42822777,43126362,43190378,43258005,43301459,43352765,43589836,43866704,44017971,44118825,44231990,44245787,44259757,44282517,44439069,44470955,44506576,44787113,44890983,44915114,44950878,45075646,45199500,45379089,45473920,45542574,45772224,45910474,46025406,46055324,46453711,46588323,46716815,46802702,47259470,47271897,47368258,47667333,48023108,48849217,48899229,49042192,49205358,49331559,49477991,49572152,49588583,49777371,50072344,50252930,50319225,50396724,50516856,50942446,51023803,52095287,52175721,52241107,52268202,52333556,52454084,52615771,52671874,52809388,52962433,52970381,53162961,53456077,53580299,53587489,53634984,53803910,54129165,54269031,54384445,54491356,54975729,55005854,55553167,55553620,55682960,55688314,55708604,55845564,55981574,560006,2543357,2923021,4209637,4608989,4645552,5370006,5731533,5763969,5866205,6049311,6296603,6342311,7168985,7258784,8136851,8166211,8577641,8615751,8620362,8717383,9113266,9148954,9570292,9584654,9603211,9733686,9920124,10138018,10160317,10270526,10280163,10663878,10844889,10853256,10869600,11069963,11131801,11158889,11310902,11369081,11402943,11523531,11697562,11725088,11834538,11992159,12085902,12376115,12444134,12575319,12597907,12612197,12656440,12952985,13412270,13490333,13510414,13667934,13744466,13773615,13794975,13797038,13899297,14027481,14110654,14176330,14183626,14330893,14358801,14558540,14656445,15200344,15226559,15244655,15559352,15616641,15617490,16356199,16587759,16708712,16939962,17268172,17596672,17659899,17831915,17944769,18054342,18078475,18176414,18365444,18374687,18403272,18443074,18518457,18635859,18653838,18670979,18931196,19175086,19269519,19383046,19503164,19533315,19558303,20299372,20355839,20398666,20416228,20662767,20815209,20841187,20901037,20923857,20965305,21162679,21221088,21281413,21368011,21384042,21496496,21810409,21945515,21963433,22070320,22268246,22701950,22763803,22809006,22979262,23005376,23087549,23125714,23152151,23184349,23221007,23445771,23457635,23520357,23571630,23789009,24150475,24261462,24321596,24788996,25115125,25118473,25192607,25346470,25517475,25949661,26113084,26266467,26278551,26334185,26374342,26534852,26651951,26670820,26703817,26706398,26807873,26933338,27149731,27236117,27366112,27417444,27538754,27559665,27595376,27616741,28002960,28250239,28259162,28347534,28486803,28561949,28566489,28806923,28895316,28977351,29050054,29175115,29220691,29308493,29507856,29545290,29643329,29730724,29749514,29788591,29795883,29805588,29810469,29873578,29929794,30045992,30253998,30352849,30551522,30613660,30686992,30850186,30955983,31104351,31243894,31427338,31653048,31653245,31676282,31766828,31804269,31976242,32167419,32178820,32204414,32209194,32269519,32275512,32319331,32393698,32427093,32541239,32617585,32642851,32672253,32942720,33143268,33187247,33256288,33366449,33494987,33552216,33586638,33590305,33591961,33618191,33681376,34060235,34466982,34557712,34702666,34708387,34868195,35252575,35332020,35497946,35497964,35549533,35693264,35914650,35976603,36053385,36092565,36338432,36373533,36512049,36523132,36564434,36601166,36735910,36846085,37370249,37617173,37666061,37684436,37765135,37816976,38238363,38300115,38334747,38671182,38681418,38843217,38904362,38904362,39037928,39233138,39268432,39427521,39439365,39462048,39784610,39997099,40015644,40125057,40217754,40237594,40313481,40471235,40519783,40526356,40611808,40704077,40828270,40977348,41286761,41313003,41563895,41563897,41821924,41843713,42060276,42250978,42976849,43112609,43254482,43359649,43427889,43628193,43887920,44232400,44679028,45118268,45197334,45250051,45258819,45432641,45540503,45667987,45667987,45726250,45736085,45760861,45781647,45893780,46094215,46207138,46260542,46277144,46343211,46649922,46680080,46916086,46987326,47141031,47473010,47478820,47660583,47902521,47955507,48006836,48019234,48132069,48149583,48445377,48448588,48982124,49001465,49230344,49624362,49657185,49803385,49829237,50037914,50079226,50273502,50508946,50523918,50643390,39233138,50923433,51448369,51645541,51692602,51980772,52038658,52143991,52306255,52791021,52900023,52942822,53569543,53993132,54178741,54618631,55063368,55475988,55528673,55601087,55865385,55868868,514517,1318955,1460531,1582903,1721911,3086406,3272126,3275379,3490999,3498816,4291761,4315367,4430047,4531464,5147430,5239735,5299411,5761842,6632209,7234654,7643008,7896397,8037122,8048636,8218524,8279939,8696030,9196192,9660168,10055551,10352231,10895018,11061143,11266091,11456310,11620982,11709155,11727032,11732184,11830636,11938690,12180861,12219643,12509737,12631280,12775631,13168163,13363666,13401681,13607810,13673381,13673381,14090649,14295201,14299498,14833921,15062297,15247892,15310530,15376996,15498722,15901591,15913821,16148101,16523245,16575426,16621809,16849913,16912368,17065946,17249470,17533368,17558331,17750618,17823100,17892107,17955511,18114286,18266011,18277576,20041558,20067797,20226848,20248588,20387055,20413155,20578963,20587235,20597704,20692655,20835681,21396800,21459305,21505671,21756392,21963319,22030553,22089094,22119882,22155631,22392071,22430939,22555650,23094548,23292037,23462834,23607026,23618258,23857995,24032220,24164199,24339850,24445163,24487545,24704262,25371794,25957993,26133705,26321860,26351539,26607409,26783818,26797049,27141186,27297618,27532110,27537995,27553766,27577280,27620077,27651724,27765983,28231279,28357108,28382894,28467274,28726502,29019131,29203801,29214653,29236493,29504539,29716191,29723153,29805223,30465037,30881191,30960635,31650184,31708000,31745480,31826470,32353429,32502630,32675997,32770815,32771266,32918963,33072851,33148867,33602297,33641677,33643311,33747984,33770290,33792425,33838178,33919877,34120216,34220750,34241421,34249550,34598078,34643059,34648570,34938619,34966098,35138755,35560225,35823736,35842942,35889474,35926129,35971935,35995971,36022198,36432392,36432553,36924731,37086470,37092427,37118651,37264012,37483528,37704902,37714318,37727402,38049902,38063143,38086081,38110852,38313839,38334528,38504255,38672135,38891160,39040543,39139491,39183501,39237587,39402720,39551445,39813738,39951997,40033661,40040701,40171820,40235863,40267509,40310563,40345985,40372658,40425316,40454158,40855794,40960619,41048353,41048965,41629983,42247551,42285669,42306581,42650360,42771800,42880771,42981575,43017368,43169475,43174426,43196972,43311175,43461724,43518846,43662415,43724721,43964137,44005916,44139492,44157398,44573866,44587005,44628721,44629671,44699412,44810010,44922210,45007179,45125055,45192155,45195931,45240804,45538009,45610309,45702529,45789765,45837544,45872547,45907214,45964421,46127745,46215793,46520070,46582357,46651492,46674148,46787348,46870164,47046198,47092339,47146119,47197865,47242304,47242896,47539689,47570669,47657146,47738713,47930656,48023926,48050732,48253529,48277470,48424108,48488955,48498763,48530763,48568006,48597015,48784646,49063612,49072401,49137865,49194724,49612466,49712373,49767831,49801154,49807694,49808459,49808855,50032469,50198000,50383046,50468424,50543293,50665718,50823355,50828912,50912438,50959129,50976737,51045526,51064565,51087761,51092254,51191109,51217365,51368086,51406614,51440674,51514862,51523332,51750300,51788805,51846665,51851722,51971005,52022412,52100343,52127982,52137676,52153588,52288027,52329084,52385326,52413499,52467937,52560553,52751945,52829505,52975797,52988925,53142133,53227287,53312361,53420325,53474179,53530646,53540698,53568218,53806369,53986971,54033878,54117000,54303414,54323332,54355276,54901809,54918427,54996120,55008623,55069962,55165291,55352817,55756492,55820395,55843569,55844698,55944669,56169081,56341879,56403974,361158,1606967,1727150,1938319,1947343,2015329,2116999,2182488,2563426,2604454,2859362,3360387,3439495,3654309,4126533,4168659,4217452,4325585,4379154,4556879,4684900,4694816,4777541,4988445,5013708,5115995,5135509,5169321,5453261,5767092,5889651,6148209,6254602,6870575,7493521,8142097,8155443,8197624,8261392,8273826,8283470,8299499,8537652,8623341,8717759,8946209,8974368,9254988,9262981,9267268,9509032,9798430,9818245,9925196,10002805,10087552,10158545,10246492,10341595,10879118,10985461,10994146,11152781,11183232,11384073,11468529,11545703,11623633,11682656,11741915,11801725,11815880,11826470,12065201,12113136,12330345,12341744,12559448,12760132,12911772,12960000,12973748,13050303,13310791,13316398,13386360,13548302,13646997,13988418,14183099,14246712,14319623,14336386,14377232,14384225,14435255,14505065,14540400,14625227,14716556,14902902,14951869,15040541,15127813,15262932,15275622,15563455,15595034,15618861,15640688,15678836,15849329,16058967,16063924,16152352,16605563,16623428,16675998,16708675,16726135,17031532,17135768,17212266,17253665,17374352,17403187,17799399,17808106,17867875,17994028,18344018,18382681,19045774,19097179,19098833,19263216,19443594,19694159,19700238,19732758,20424188,20517410,20542629,20552569,21195919,21260669,21642984,21661883,21751376,21892282,22013847,22303390,22335133,22395788,22443141,22507973,22540389,22598814,22628009,22648500,23397767,23428647,23429229,23475753,23627409,23675576,23845349,23929136,24082528,24136031,24534339,24617748,24703200,24714459,24741513,24861566,24973371,25084373,25283650,25447101,25547280,25548715,25618303,26175327,26227896,26254861,26304744,26422593,26548074,26612264,26798022,26908353,26923279,27088557,27173543,27240944,27251625,27536719,27646170,27816725,28015389,28050921,28080459,28131480,28335740,28362194,28456193,28786403,28824504,28972885,29067911,29208158,29534808,29625108,29893244,29942398,30305493,30446432,30458638,31014364,31212242,31240497,31248225,31449102,31714336,31745553,31809481,31863695,32080037,32207358,32248981,32805259,32843260,32935102,33064890,33191679,33219006,33444867,33476734,33627839,33657815,33666531,33851640,33971929,34037428,34069130,34073927,34181379,34195196,34266530,34408681,34445236,34510608,34558760,34589083,34759591,35020809,35308527,35372103,35403389,35510889,35560590,35590767,35590767,35599495,35612690,35648172,35693578,35746396,35921671,36163352,36188657,36205392,36264688,36301610,36323513,36900249,37187703,37540031,37965678,38246557,38251855,38518129,38547346,38763036,38820880,38895360,39026239,39075574,39151637,39249372,39455641,39509953,39562935,39657730,39697649,39763827,39766730,40001644,40024330,40235904,40247568,40623299,40883247,41078076,41271166,41302883,41373257,41555552,41806935,41817966,41916833,42136728,42577798,42745733,42815555,42957683,43123967,43127565,43414677,43416996,44037321,44066476,44082117,44216536,44328262,44478159,44677700,44811535,44911113,45503027,45545901,45565196,45732890,45972454,46300143,46531352,46594126,46704641,47052559,47091110,47100316,47141669,47307533,47460589,47550143,47732187,47771377,47869082,47991819,48161594,48201601,48539665,48562953,48863574,49222391,49239091,49587665,49643201,49806413,49994300,50000804,50808175,51199783,51319585,51936077,52338027,52341611,52464631,52607832,52753839,52941625,54365760,54409153,54808259,55010830,55053845,55110864,55327050,55792385,55988793,56378053);",
        conn, parse_dates={"CreationDate": "%Y-%m-%d %H:%M:%S"})
    df_questions = pd.read_sql_query(
        "SELECT * FROM EditHistory WHERE Event = 'InitialBody' AND PostId IN (SELECT DISTINCT ParentId FROM EditHistory WHERE PostId IN (818313,939060,1417254,1276894,1804490,2061144,2256556,3366318,3347598,3383237,4040641,4323607,4357318,4605982,5112457,5326382,5553947,6330456,6872517,6954573,7271326,7498411,6908115,7891698,8203073,9043462,9236878,9239808,9397206,9556452,9630432,9686046,10060390,10150458,2206432,10284119,10343816,10374564,10405545,10498341,10547344,11020094,11217492,11649404,11847167,11884184,12002701,12024009,12154831,12242834,12452881,12586471,12638451,12836218,12892964,13039557,13479302,13594807,13608535,13636838,13675924,13703279,13821778,14146919,14274978,14499028,14778058,14861957,15013259,15030050,15555250,15795118,15801490,15762726,15836989,15883604,15957975,15976303,15984885,16251905,16346563,16433740,7080110,17057187,17191396,17319638,17534943,17599402,17761938,17829520,17890507,17913039,18048949,18194951,18243157,18443074,18493467,18505187,18894906,19120443,19170570,19345640,19941171,20051167,20281502,20389922,20522648,20564980,20643356,20682670,20830515,20979166,20982407,21051450,21221088,21397451,21467987,21508484,21563424,21574754,21546112,21900743,21928787,22244318,19760247,22453634,22547276,22558242,22632211,22719774,22729235,22755610,22790433,22801381,22815825,23047291,23485518,23596935,23746834,23836513,23966454,23966579,24053116,24097089,24097395,24112752,24222260,24261239,24354619,24374760,24466679,24527796,13490879,24711801,24994747,25048956,25213188,25363478,25478667,25567294,25570082,25722877,25941522,26128045,26131972,26166810,26275516,26464722,22840483,26575292,26684874,26707401,26742187,26743196,26875502,26895625,26963815,26996935,27129527,27249942,27300544,27460666,27467436,27598202,28161001,28246170,28372662,28567081,28759071,29019668,29059351,29065976,21757928,4903603,29497063,29590346,29690325,29787277,29720760,29811000,29990543,30006033,30006383,30007770,30030466,30040186,30065760,30199210,30279363,30511497,30866171,30994088,31392227,31494182,31545286,31799561,31874400,32236521,32545385,32749983,32754922,33075045,33114312,33191611,33776967,34629675,35004710,35739045,35743682,35890604,36269980,36320155,36486897,36565615,36608850,37012846,37066827,37173859,37285008,37339594,37318859,37453268,37508304,37697179,37762134,37769932,37992391,38024945,38037269,38400960,38536173,38587221,38667012,38699205,33437366,38783706,35219474,38824811,39167699,39220959,39281965,39566876,39569666,39706712,39796059,40096675,40164633,40201740,21970805,40440530,40474532,40605034,41083139,41462630,6667403,41568370,41609515,41662470,41761656,41770767,41843713,42374536,42464496,42469760,42505230,42525241,42666184,42722091,42745270,42842593,43100605,43136269,43279035,43280212,43361112,43511213,43642366,27506104,43770851,43835126,43875064,44364052,44398934,44405921,44460065,45111288,45337346,45488299,45857726,45720860,46393474,46428741,46671750,46675245,46770584,46911175,47104641,47406508,47415643,47545712,47582363,47743840,47818939,47845637,48210898,48391112,48417942,48430421,48445377,48608229,48909781,49054649,49060906,27173320,49324753,49488361,49556258,49594320,49605667,49611325,49879709,49876892,50064265,50085689,50107889,50153682,50196591,50328445,50416883,50401250,50547398,50942905,51537352,51664465,52098233,52172471,52324512,52466191,52517618,52524114,52879125,52980017,53062115,53175054,53216022,53354155,53644456,53692842,53708081,53830302,53852343,53927692,54615947,54892387,54886614,55117356,55652916,55788001,55855047,55879567,55884358,55957419,7875,1757843,2486471,2494473,2550109,2861345,2901136,2931250,3180655,3359695,3517919,3835837,3941993,3998810,4002998,4067488,4132683,4221530,4324452,4528579,4769473,4812456,4941028,4942094,5518611,5586896,5616616,6010680,6722434,7008045,7078376,7126108,7235584,7460596,7499793,7544391,7936715,7947296,7967539,8037909,8253636,8329078,8365193,8525234,8832616,8961590,9247380,9575427,9671062,9756189,9765719,9842690,9946432,9967906,10002834,10059880,10261872,10270684,10273530,10457243,10474157,10575359,10675391,10986507,11013401,11100438,11261905,11267066,11530571,11617389,11814973,12011946,12084655,12285644,12372494,12414939,12926968,12956052,13202590,13823883,13938724,13955260,13988109,14062168,14148205,14385245,14395504,14534000,14671329,15639564,15795612,15831048,15840470,15915111,16184706,16223058,16273678,16384427,16464249,16578216,16588794,16696265,16952627,17387979,17422278,17544435,17861364,18140785,18443615,18601061,18756993,18787645,18874276,19200180,19457772,19533769,19557345,19613767,19700790,19782902,19947286,20283372,20617878,20658703,20934707,21160142,21232710,21249586,21415825,21435581,21616835,21663663,21743445,21761849,22519985,22542942,22584238,22666420,22682946,22691984,22739509,23341180,23406739,23660859,23679600,23930639,23986040,24031643,24062304,24160444,24403148,24964658,25210874,25211347,25265847,25297013,25360511,25566304,25633751,26037257,26051940,26183490,26299482,26341492,26359016,26410127,26797389,26954938,27048844,27221870,27396031,27667930,27682935,27692016,27729621,28072526,28453744,28543628,29139345,29149361,29169171,29313135,29411594,29597612,29668832,29790728,29818178,29842091,30136118,30224730,30416453,30477785,30566591,30649339,30693676,30832210,30840682,30963999,31011581,31028728,31126573,31251788,31570036,31609446,31786814,31962949,31984465,32285180,32324152,32446063,32452510,32522692,32534927,32710344,32714867,33093774,33098354,33176109,33506602,33529736,33605139,33721002,33743060,33832748,34112810,34376447,34423517,34455384,34574477,34575648,34621690,35216133,35249783,35811456,35932904,36073686,36171692,36373663,36405138,36440703,36868781,36956622,37012089,37015421,37044830,37092024,37136990,37278168,37368674,37386443,37641990,37702078,37776174,37901571,38236739,38257253,38327251,38651536,38723725,38934148,39120587,39208329,39395659,39599651,39671852,39856353,39864295,39910967,39977973,40050521,40132610,40335689,40367309,40542626,40736514,40813524,40825464,40963516,41063137,41067576,41114471,41115444,41481803,41737893,41809552,41812258,41865284,42078133,42187180,42253098,42301905,42316411,42416986,42464221,42611016,42753376,42754141,42822777,43126362,43190378,43258005,43301459,43352765,43589836,43866704,44017971,44118825,44231990,44245787,44259757,44282517,44439069,44470955,44506576,44787113,44890983,44915114,44950878,45075646,45199500,45379089,45473920,45542574,45772224,45910474,46025406,46055324,46453711,46588323,46716815,46802702,47259470,47271897,47368258,47667333,48023108,48849217,48899229,49042192,49205358,49331559,49477991,49572152,49588583,49777371,50072344,50252930,50319225,50396724,50516856,50942446,51023803,52095287,52175721,52241107,52268202,52333556,52454084,52615771,52671874,52809388,52962433,52970381,53162961,53456077,53580299,53587489,53634984,53803910,54129165,54269031,54384445,54491356,54975729,55005854,55553167,55553620,55682960,55688314,55708604,55845564,55981574,560006,2543357,2923021,4209637,4608989,4645552,5370006,5731533,5763969,5866205,6049311,6296603,6342311,7168985,7258784,8136851,8166211,8577641,8615751,8620362,8717383,9113266,9148954,9570292,9584654,9603211,9733686,9920124,10138018,10160317,10270526,10280163,10663878,10844889,10853256,10869600,11069963,11131801,11158889,11310902,11369081,11402943,11523531,11697562,11725088,11834538,11992159,12085902,12376115,12444134,12575319,12597907,12612197,12656440,12952985,13412270,13490333,13510414,13667934,13744466,13773615,13794975,13797038,13899297,14027481,14110654,14176330,14183626,14330893,14358801,14558540,14656445,15200344,15226559,15244655,15559352,15616641,15617490,16356199,16587759,16708712,16939962,17268172,17596672,17659899,17831915,17944769,18054342,18078475,18176414,18365444,18374687,18403272,18443074,18518457,18635859,18653838,18670979,18931196,19175086,19269519,19383046,19503164,19533315,19558303,20299372,20355839,20398666,20416228,20662767,20815209,20841187,20901037,20923857,20965305,21162679,21221088,21281413,21368011,21384042,21496496,21810409,21945515,21963433,22070320,22268246,22701950,22763803,22809006,22979262,23005376,23087549,23125714,23152151,23184349,23221007,23445771,23457635,23520357,23571630,23789009,24150475,24261462,24321596,24788996,25115125,25118473,25192607,25346470,25517475,25949661,26113084,26266467,26278551,26334185,26374342,26534852,26651951,26670820,26703817,26706398,26807873,26933338,27149731,27236117,27366112,27417444,27538754,27559665,27595376,27616741,28002960,28250239,28259162,28347534,28486803,28561949,28566489,28806923,28895316,28977351,29050054,29175115,29220691,29308493,29507856,29545290,29643329,29730724,29749514,29788591,29795883,29805588,29810469,29873578,29929794,30045992,30253998,30352849,30551522,30613660,30686992,30850186,30955983,31104351,31243894,31427338,31653048,31653245,31676282,31766828,31804269,31976242,32167419,32178820,32204414,32209194,32269519,32275512,32319331,32393698,32427093,32541239,32617585,32642851,32672253,32942720,33143268,33187247,33256288,33366449,33494987,33552216,33586638,33590305,33591961,33618191,33681376,34060235,34466982,34557712,34702666,34708387,34868195,35252575,35332020,35497946,35497964,35549533,35693264,35914650,35976603,36053385,36092565,36338432,36373533,36512049,36523132,36564434,36601166,36735910,36846085,37370249,37617173,37666061,37684436,37765135,37816976,38238363,38300115,38334747,38671182,38681418,38843217,38904362,38904362,39037928,39233138,39268432,39427521,39439365,39462048,39784610,39997099,40015644,40125057,40217754,40237594,40313481,40471235,40519783,40526356,40611808,40704077,40828270,40977348,41286761,41313003,41563895,41563897,41821924,41843713,42060276,42250978,42976849,43112609,43254482,43359649,43427889,43628193,43887920,44232400,44679028,45118268,45197334,45250051,45258819,45432641,45540503,45667987,45667987,45726250,45736085,45760861,45781647,45893780,46094215,46207138,46260542,46277144,46343211,46649922,46680080,46916086,46987326,47141031,47473010,47478820,47660583,47902521,47955507,48006836,48019234,48132069,48149583,48445377,48448588,48982124,49001465,49230344,49624362,49657185,49803385,49829237,50037914,50079226,50273502,50508946,50523918,50643390,39233138,50923433,51448369,51645541,51692602,51980772,52038658,52143991,52306255,52791021,52900023,52942822,53569543,53993132,54178741,54618631,55063368,55475988,55528673,55601087,55865385,55868868,514517,1318955,1460531,1582903,1721911,3086406,3272126,3275379,3490999,3498816,4291761,4315367,4430047,4531464,5147430,5239735,5299411,5761842,6632209,7234654,7643008,7896397,8037122,8048636,8218524,8279939,8696030,9196192,9660168,10055551,10352231,10895018,11061143,11266091,11456310,11620982,11709155,11727032,11732184,11830636,11938690,12180861,12219643,12509737,12631280,12775631,13168163,13363666,13401681,13607810,13673381,13673381,14090649,14295201,14299498,14833921,15062297,15247892,15310530,15376996,15498722,15901591,15913821,16148101,16523245,16575426,16621809,16849913,16912368,17065946,17249470,17533368,17558331,17750618,17823100,17892107,17955511,18114286,18266011,18277576,20041558,20067797,20226848,20248588,20387055,20413155,20578963,20587235,20597704,20692655,20835681,21396800,21459305,21505671,21756392,21963319,22030553,22089094,22119882,22155631,22392071,22430939,22555650,23094548,23292037,23462834,23607026,23618258,23857995,24032220,24164199,24339850,24445163,24487545,24704262,25371794,25957993,26133705,26321860,26351539,26607409,26783818,26797049,27141186,27297618,27532110,27537995,27553766,27577280,27620077,27651724,27765983,28231279,28357108,28382894,28467274,28726502,29019131,29203801,29214653,29236493,29504539,29716191,29723153,29805223,30465037,30881191,30960635,31650184,31708000,31745480,31826470,32353429,32502630,32675997,32770815,32771266,32918963,33072851,33148867,33602297,33641677,33643311,33747984,33770290,33792425,33838178,33919877,34120216,34220750,34241421,34249550,34598078,34643059,34648570,34938619,34966098,35138755,35560225,35823736,35842942,35889474,35926129,35971935,35995971,36022198,36432392,36432553,36924731,37086470,37092427,37118651,37264012,37483528,37704902,37714318,37727402,38049902,38063143,38086081,38110852,38313839,38334528,38504255,38672135,38891160,39040543,39139491,39183501,39237587,39402720,39551445,39813738,39951997,40033661,40040701,40171820,40235863,40267509,40310563,40345985,40372658,40425316,40454158,40855794,40960619,41048353,41048965,41629983,42247551,42285669,42306581,42650360,42771800,42880771,42981575,43017368,43169475,43174426,43196972,43311175,43461724,43518846,43662415,43724721,43964137,44005916,44139492,44157398,44573866,44587005,44628721,44629671,44699412,44810010,44922210,45007179,45125055,45192155,45195931,45240804,45538009,45610309,45702529,45789765,45837544,45872547,45907214,45964421,46127745,46215793,46520070,46582357,46651492,46674148,46787348,46870164,47046198,47092339,47146119,47197865,47242304,47242896,47539689,47570669,47657146,47738713,47930656,48023926,48050732,48253529,48277470,48424108,48488955,48498763,48530763,48568006,48597015,48784646,49063612,49072401,49137865,49194724,49612466,49712373,49767831,49801154,49807694,49808459,49808855,50032469,50198000,50383046,50468424,50543293,50665718,50823355,50828912,50912438,50959129,50976737,51045526,51064565,51087761,51092254,51191109,51217365,51368086,51406614,51440674,51514862,51523332,51750300,51788805,51846665,51851722,51971005,52022412,52100343,52127982,52137676,52153588,52288027,52329084,52385326,52413499,52467937,52560553,52751945,52829505,52975797,52988925,53142133,53227287,53312361,53420325,53474179,53530646,53540698,53568218,53806369,53986971,54033878,54117000,54303414,54323332,54355276,54901809,54918427,54996120,55008623,55069962,55165291,55352817,55756492,55820395,55843569,55844698,55944669,56169081,56341879,56403974,361158,1606967,1727150,1938319,1947343,2015329,2116999,2182488,2563426,2604454,2859362,3360387,3439495,3654309,4126533,4168659,4217452,4325585,4379154,4556879,4684900,4694816,4777541,4988445,5013708,5115995,5135509,5169321,5453261,5767092,5889651,6148209,6254602,6870575,7493521,8142097,8155443,8197624,8261392,8273826,8283470,8299499,8537652,8623341,8717759,8946209,8974368,9254988,9262981,9267268,9509032,9798430,9818245,9925196,10002805,10087552,10158545,10246492,10341595,10879118,10985461,10994146,11152781,11183232,11384073,11468529,11545703,11623633,11682656,11741915,11801725,11815880,11826470,12065201,12113136,12330345,12341744,12559448,12760132,12911772,12960000,12973748,13050303,13310791,13316398,13386360,13548302,13646997,13988418,14183099,14246712,14319623,14336386,14377232,14384225,14435255,14505065,14540400,14625227,14716556,14902902,14951869,15040541,15127813,15262932,15275622,15563455,15595034,15618861,15640688,15678836,15849329,16058967,16063924,16152352,16605563,16623428,16675998,16708675,16726135,17031532,17135768,17212266,17253665,17374352,17403187,17799399,17808106,17867875,17994028,18344018,18382681,19045774,19097179,19098833,19263216,19443594,19694159,19700238,19732758,20424188,20517410,20542629,20552569,21195919,21260669,21642984,21661883,21751376,21892282,22013847,22303390,22335133,22395788,22443141,22507973,22540389,22598814,22628009,22648500,23397767,23428647,23429229,23475753,23627409,23675576,23845349,23929136,24082528,24136031,24534339,24617748,24703200,24714459,24741513,24861566,24973371,25084373,25283650,25447101,25547280,25548715,25618303,26175327,26227896,26254861,26304744,26422593,26548074,26612264,26798022,26908353,26923279,27088557,27173543,27240944,27251625,27536719,27646170,27816725,28015389,28050921,28080459,28131480,28335740,28362194,28456193,28786403,28824504,28972885,29067911,29208158,29534808,29625108,29893244,29942398,30305493,30446432,30458638,31014364,31212242,31240497,31248225,31449102,31714336,31745553,31809481,31863695,32080037,32207358,32248981,32805259,32843260,32935102,33064890,33191679,33219006,33444867,33476734,33627839,33657815,33666531,33851640,33971929,34037428,34069130,34073927,34181379,34195196,34266530,34408681,34445236,34510608,34558760,34589083,34759591,35020809,35308527,35372103,35403389,35510889,35560590,35590767,35590767,35599495,35612690,35648172,35693578,35746396,35921671,36163352,36188657,36205392,36264688,36301610,36323513,36900249,37187703,37540031,37965678,38246557,38251855,38518129,38547346,38763036,38820880,38895360,39026239,39075574,39151637,39249372,39455641,39509953,39562935,39657730,39697649,39763827,39766730,40001644,40024330,40235904,40247568,40623299,40883247,41078076,41271166,41302883,41373257,41555552,41806935,41817966,41916833,42136728,42577798,42745733,42815555,42957683,43123967,43127565,43414677,43416996,44037321,44066476,44082117,44216536,44328262,44478159,44677700,44811535,44911113,45503027,45545901,45565196,45732890,45972454,46300143,46531352,46594126,46704641,47052559,47091110,47100316,47141669,47307533,47460589,47550143,47732187,47771377,47869082,47991819,48161594,48201601,48539665,48562953,48863574,49222391,49239091,49587665,49643201,49806413,49994300,50000804,50808175,51199783,51319585,51936077,52338027,52341611,52464631,52607832,52753839,52941625,54365760,54409153,54808259,55010830,55053845,55110864,55327050,55792385,55988793,56378053));",
        conn, parse_dates={"CreationDate": "%Y-%m-%d %H:%M:%S"})

    return df_questions, df_answers, df_comments, df_edits


def full(clean, filter_user, naive):
    conn = sqlite3.connect("sotorrent.sqlite3")
    print("Connection made")
    if clean:
        setup_sqlite(conn)
    start = time.time()
    df_questions, df_answers, df_comments, df_edits = get_data(conn)
    end = time.time()
    print("Data loading took {0:2f} seconds".format(end - start))

    pipeline = Processor(conn, df_questions, df_answers, df_comments, df_edits, filter_user, naive)
    start = time.time()
    pipeline.process()
    end = time.time()
    print("Took {0:2f} seconds to process".format(end - start))

    # Generate the statistics
    stats()

    # Package the results into JSON
    package(conn, "results.csv")
    print("Finished packaging pairs into JSON")
    conn.close()


def stats():
    start = time.time()

    generate_result_stats()
    generate_simple_csvs()
    # generate_stat_csv()

    end = time.time()

    print("Took {0:2f} seconds to generate files".format(end - start))


def main():
    parser = argparse.ArgumentParser(description="SOTorrent - Comment Induced Updates")
    parser.add_argument("--stage", "-s", help="Stage of Analysis: FULL, STATS, NAIVE, EVAL, PACK", type=str, nargs="+")
    parser.add_argument("--clean", "-c", help="(Re)Make SQL Tables: True, False", type=str, default="T")
    parser.add_argument("--user", "-u", help="Allow commenters to also be editors: True, False", type=str, default="F")

    arg_stage = parser.parse_args().stage[0].upper().strip() if parser.parse_args().stage else None
    if arg_stage is None:
        print("Please specify a stage")
    elif arg_stage == "FULL":
        arg_clean = True if parser.parse_args().clean.upper().strip()[:1] == "T" else False
        arg_filter_user = True if parser.parse_args().user.upper().strip()[:1] == "F" else False
        full(arg_clean, arg_filter_user, False)
    elif arg_stage == "STATS":
        stats()
    elif arg_stage == "NAIVE":
        arg_clean = True if parser.parse_args().clean.upper().strip()[:1] == "T" else False
        arg_filter_user = True if parser.parse_args().user.upper().strip()[:1] == "F" else False
        full(arg_clean, arg_filter_user, True)
    elif arg_stage == "EVAL":
        evaluate()
    elif arg_stage == "PACK":
        try:
            csv = parser.parse_args().stage[1]
            conn = sqlite3.connect("sotorrent.sqlite3")
            package(conn, csv)
            conn.close()
        except IndexError:
            print("Please provide a CSV to pack into JSON")


main()
